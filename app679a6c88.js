(()=>{"use strict";const t=["en","ru"],e={ShiftLeft_AltLeft:"lang",AltLeft_ShiftLeft:"lang"},i={functional:{Escape:"Escape",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12",Tab:"tab",CapsLock:"caps",ShiftLeft:"shift",ShiftRight:"shift",ControlLeft:"ctrl",MetaLeft:"win",AltLeft:"alt",Space:" ",AltRight:"alt",MetaRight:"win",ContextMenu:"ContextMenu",ControlRight:"ctrl",ScrollLock:"scroll lock",Pause:"pause",PageUp:"page up",PageDown:"page down",End:"end",Home:"home",Insert:"ins",Delete:"del",Backspace:"⟵",ArrowUp:"˄",ArrowLeft:"˂",ArrowRight:"˃",ArrowDown:"˅",NumLock:"num lock",Enter:"⮠"},symbols:{en:{Digit1:{shift:"!",main:"1"},Digit2:{shift:"@",main:"2"},Digit3:{shift:"#",main:"3"},Digit4:{shift:"$",main:"4"},Digit5:{shift:"%",main:"5"},Digit6:{shift:"^",main:"6"},Digit7:{shift:"&",main:"7"},Digit8:{shift:"*",main:"8"},Digit9:{shift:"(",main:"9"},Digit0:{shift:")",main:"0"},Minus:{shift:"_",main:"-"},Equal:{shift:"+",main:"="},Backslash:{shift:"|",main:"\\"},KeyQ:{shift:"Q",main:"q"},KeyW:{shift:"W",main:"w"},KeyE:{shift:"E",main:"e"},KeyR:{shift:"R",main:"r"},KeyT:{shift:"T",main:"t"},KeyY:{shift:"Y",main:"y"},KeyU:{shift:"U",main:"u"},KeyI:{shift:"I",main:"i"},KeyO:{shift:"O",main:"o"},KeyP:{shift:"P",main:"p"},BracketLeft:{shift:"{",main:"["},BracketRight:{shift:"}",main:"]"},KeyA:{shift:"A",main:"a"},KeyS:{shift:"S",main:"s"},KeyD:{shift:"D",main:"d"},KeyF:{shift:"F",main:"f"},KeyG:{shift:"G",main:"g"},KeyH:{shift:"H",main:"h"},KeyJ:{shift:"J",main:"j"},KeyK:{shift:"K",main:"k"},KeyL:{shift:"L",main:"l"},Semicolon:{shift:":",main:";"},Quote:{shift:'"',main:"'"},KeyZ:{shift:"Z",main:"z"},KeyX:{shift:"X",main:"x"},KeyC:{shift:"C",main:"c"},KeyV:{shift:"V",main:"v"},KeyB:{shift:"B",main:"b"},KeyN:{shift:"N",main:"n"},KeyM:{shift:"M",main:"m"},Comma:{shift:"<",main:","},Period:{shift:">",main:"."},Slash:{shift:"?",main:"/"},Backquote:{shift:"~",main:"`"}},ru:{Backquote:{shift:"Ё",main:"ё"},Digit1:{shift:"!",main:"1"},Digit2:{shift:'"',main:"2"},Digit3:{shift:"№",main:"3"},Digit4:{shift:";",main:"4"},Digit5:{shift:"%",main:"5"},Digit6:{shift:":",main:"6"},Digit7:{shift:"?",main:"7"},Digit8:{shift:"*",main:"8"},Digit9:{shift:"(",main:"9"},Digit0:{shift:")",main:"0"},Minus:{shift:"_",main:"-"},Equal:{shift:"+",main:"="},Backslash:{shift:"/",main:"\\"},KeyQ:{shift:"Й",main:"й"},KeyW:{shift:"Ц",main:"ц"},KeyE:{shift:"У",main:"у"},KeyR:{shift:"К",main:"к"},KeyT:{shift:"Е",main:"е"},KeyY:{shift:"Н",main:"н"},KeyU:{shift:"Г",main:"г"},KeyI:{shift:"Ш",main:"ш"},KeyO:{shift:"Щ",main:"щ"},KeyP:{shift:"З",main:"з"},BracketLeft:{shift:"Х",main:"х"},BracketRight:{shift:"Ъ",main:"ъ"},KeyA:{shift:"Ф",main:"ф"},KeyS:{shift:"Ы",main:"ы"},KeyD:{shift:"В",main:"в"},KeyF:{shift:"А",main:"а"},KeyG:{shift:"П",main:"п"},KeyH:{shift:"Р",main:"р"},KeyJ:{shift:"О",main:"о"},KeyK:{shift:"Л",main:"л"},KeyL:{shift:"Д",main:"д"},Semicolon:{shift:"Ж",main:"ж"},Quote:{shift:"Э",main:"э"},KeyZ:{shift:"Я",main:"я"},KeyX:{shift:"Ч",main:"ч"},KeyC:{shift:"С",main:"с"},KeyV:{shift:"М",main:"м"},KeyB:{shift:"И",main:"и"},KeyN:{shift:"Т",main:"т"},KeyM:{shift:"Ь",main:"ь"},Comma:{shift:"Б",main:"б"},Period:{shift:"Ю",main:"ю"},Slash:{shift:",",main:"."}}}};function s(t,e){const{attributes:i={},classNames:s=[],children:a=""}=e,o=document.createElement(t);return Object.entries(i).forEach((([t,e])=>{o.setAttribute(t,e)})),o.classList.add(...s),o.innerHTML=a,o}const a=s("h1",{classNames:["heading"],children:"RSS Virtual Keyboard"});document.body.append(a);const o=s("textarea",{classNames:["textarea"],attributes:{cols:50,placeholder:"Please start input..."}});document.body.append(o),new class{constructor(e,i){this._textarea=i,this._layout=e,this._keysElements={},this._caps=!1,this._shift=!1,this._alt=!1,this._control=!1,this._langs=t,this._currentLang=Number(localStorage.getItem("lang"))||0}_createKeyElement(t){const e=document.createElement("button"),[i,s]=t;e.classList.add("keyboard__key",`keyboard__key_color_${s.color}`),s.widthType&&e.classList.add(`keyboard__key_type_${s.widthType}`,"keyboard__key_type_grow"),e.setAttribute("data-code",i),this._keysElements[i]=e}_updateLayout(){const t=this._shift&&!this._caps||this._caps&&!this._shift,e=this._langs[this._currentLang];Object.entries(this._keysElements).forEach((([s,a])=>{const o=i.functional[s];if(o)a.textContent=o;else{const{main:o,shift:n}=i.symbols[e][s];let r;n.toLowerCase()===o?(r=t?n:o,a.textContent=r,a.setAttribute("data-symbol",r)):(r=this._shift?n:o,a.innerHTML=`\n            <span class=${this._shift?"keyboard__key-secondary":""}>${o}</span>\n            <span class=${this._shift?"":"keyboard__key-secondary"}>${n}</span>`),a.setAttribute("data-symbol",r)}}))}_init(){const t=document.createElement("ul");t.classList.add("keyboard"),this._layout.forEach((t=>this._createKeyElement(t))),t.append(...Object.values(this._keysElements)),this._updateLayout(),this._element=t}_toggleCaps(){this._caps=!this._caps,this._updateLayout(),this._keysElements.CapsLock.classList.toggle("keyboard__key_active")}_changeLang(){const t=this._currentLang+1;this._currentLang=t<this._langs.length?t:0,localStorage.setItem("lang",this._currentLang)}handleKeyAction(t){this._textarea.focus();const{code:e,type:i,shiftKey:s,altKey:a}=t,o=this._keysElements[t.code];if(o)if(o.dataset.symbol&&"keydown"===t.type&&(t.preventDefault(),this._keysElements[t.code].dispatchEvent(new MouseEvent("click",{bubbles:!0}))),this._resetFunctionalKeys("Shift"),this._resetFunctionalKeys("Alt"),this._resetFunctionalKeys("Control"),"CapsLock"!==e){if(e.match(/alt/i)&&t.preventDefault(),a&&s&&(this._changeLang(),this._updateLayout()),"keydown"===i?o.classList.add("keyboard__key_active"):o.classList.remove("keyboard__key_active"),"Tab"===e&&"keydown"===i&&(t.preventDefault(),this._keysElements.Tab.dispatchEvent(new MouseEvent("click",{bubbles:!0}))),e.match(/shift/i)){const t="keydown"===i;this._shift!==t&&(this._shift=t,this._updateLayout())}}else"keyup"===i&&this._toggleCaps()}_moveSelection(t){let e=t;e<0&&(e=0),e>this._textarea.value.length&&(e=this._textarea.value),this._textarea.selectionStart=e,this._textarea.selectionEnd=e}_resetFunctionalKeys(t,e){this._keysElements[`${t}Left`].classList[e?"add":"remove"]("keyboard__key_active"),this._keysElements[`${t}Right`].classList[e?"add":"remove"]("keyboard__key_active"),this[`_${t.toLowerCase()}`]=e,"Shift"===t&&this._updateLayout()}_checkHotkey(t){let i;if(this._lastKey){const s=`${t}_${this._lastKey}`;i=e[s],this._lastKey=i?null:t,"lang"===i&&(this._changeLang(),this._resetFunctionalKeys("Shift",!1),this._resetFunctionalKeys("Alt",!1))}else this._lastKey=t;return Boolean(i)}handleMouseDown(t){const e=t.target.closest(".keyboard__key");if(!e)return;this._textarea.focus();const{code:i,symbol:s}=e.dataset,{selectionStart:a,value:o,cols:n}=this._textarea;if(!this._checkHotkey(i))if("CapsLock"!==i){if(i.match(/Shift/i)?this._shift?this._resetFunctionalKeys("Shift",!1):this._resetFunctionalKeys("Shift",!0):this._resetFunctionalKeys("Shift",!1),i.match(/alt/i)?this._alt?this._resetFunctionalKeys("Alt",!1):this._resetFunctionalKeys("Alt",!0):this._resetFunctionalKeys("Alt",!1),i.match(/control/i)?this._control?this._resetFunctionalKeys("Control",!1):this._resetFunctionalKeys("Control",!0):this._resetFunctionalKeys("Control",!1),s||"Space"===i){let t=s;s||(t=" "),this._textarea.value=o.slice(0,a)+t+o.slice(a),this._moveSelection(a+1)}"Backspace"===i&&o.length>0&&(this._textarea.value=o.slice(0,Math.max(a-1,0))+o.slice(a),this._moveSelection(a-1)),i.match(/del/i)&&o.length>0&&a<o.length&&(this._textarea.value=o.slice(0,a)+o.slice(a+1),this._moveSelection(a)),i.match(/enter/i)&&o.length>0&&(this._textarea.value=`${o.slice(0,a)}\n${o.slice(a)}`,this._moveSelection(a+1)),"Tab"===i&&(this._textarea.value=`${o.slice(0,a)}  ${o.slice(a)}`,this._moveSelection(a+2)),"ArrowLeft"===i&&a>0&&this._moveSelection(a-1),"ArrowRight"===i&&a<o.length&&this._moveSelection(a+1),"ArrowUp"===i&&a>0&&this._moveSelection(a-n),"ArrowDown"===i&&a<o.length&&this._moveSelection(a+n),"PageUp"===i&&a>0&&this._moveSelection(0),"PageDown"===i&&a<o.length&&this._moveSelection(o.length)}else this._toggleCaps()}_addListeners(){window.addEventListener("keydown",(t=>this.handleKeyAction(t))),window.addEventListener("keyup",(t=>this.handleKeyAction(t))),this._element.addEventListener("click",(t=>this.handleMouseDown(t)))}render(t){this._init(),t.append(this._element),this._addListeners()}show(){this.element.classList.remove("keyboard_hidden")}hide(){this.element.classList.add("keyboard_hidden")}}([["Backquote",{color:"primary"}],["Digit1",{color:"primary"}],["Digit2",{color:"primary"}],["Digit3",{color:"primary"}],["Digit4",{color:"primary"}],["Digit5",{color:"secondary"}],["Digit6",{color:"secondary"}],["Digit7",{color:"secondary"}],["Digit8",{color:"secondary"}],["Digit9",{color:"secondary"}],["Digit0",{color:"primary"}],["Minus",{color:"primary"}],["Equal",{color:"primary"}],["Backspace",{color:"secondary",widthType:"backspace"}],["Delete",{color:"secondary"}],["Tab",{color:"secondary",widthType:"tab"}],["KeyQ",{color:"primary"}],["KeyW",{color:"primary"}],["KeyE",{color:"primary"}],["KeyR",{color:"primary"}],["KeyT",{color:"primary"}],["KeyY",{color:"primary"}],["KeyU",{color:"primary"}],["KeyI",{color:"primary"}],["KeyO",{color:"primary"}],["KeyP",{color:"primary"}],["BracketLeft",{color:"primary"}],["BracketRight",{color:"primary"}],["Backslash",{color:"secondary",widthType:"backslash"}],["Insert",{color:"secondary"}],["CapsLock",{color:"secondary",widthType:"capslock"}],["KeyA",{color:"primary"}],["KeyS",{color:"primary"}],["KeyD",{color:"primary"}],["KeyF",{color:"primary"}],["KeyG",{color:"primary"}],["KeyH",{color:"primary"}],["KeyJ",{color:"primary"}],["KeyK",{color:"primary"}],["KeyL",{color:"primary"}],["Semicolon",{color:"primary"}],["Quote",{color:"primary"}],["Enter",{color:"secondary",widthType:"enter"}],["PageUp",{color:"secondary"}],["ShiftLeft",{color:"secondary",widthType:"shift-left"}],["KeyZ",{color:"primary"}],["KeyX",{color:"primary"}],["KeyC",{color:"primary"}],["KeyV",{color:"primary"}],["KeyB",{color:"primary"}],["KeyN",{color:"primary"}],["KeyM",{color:"primary"}],["Comma",{color:"primary"}],["Period",{color:"primary"}],["Slash",{color:"primary"}],["ShiftRight",{color:"secondary",widthType:"shift-right"}],["ArrowUp",{color:"primary"}],["PageDown",{color:"secondary"}],["ControlLeft",{color:"secondary",widthType:"wideKey"}],["MetaLeft",{color:"secondary",widthType:"wideKey"}],["AltLeft",{color:"secondary",widthType:"wideKey"}],["Space",{color:"primary",widthType:"space"}],["AltRight",{color:"secondary",widthType:"wideKey"}],["MetaRight",{color:"secondary",widthType:"wideKey"}],["ControlRight",{color:"secondary",widthType:"wideKey"}],["ArrowLeft",{color:"primary"}],["ArrowDown",{color:"primary"}],["ArrowRight",{color:"primary"}]],o).render(document.body);const n=s("p",{classNames:["paragraph"],children:"the keyboard was created in Windows, LeftShift + LeftAlt (LeftAlt + LeftShift too) to change the language"});document.body.append(n)})();